<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kappale 5 Datan muokkaaminen | R-ohjelmoinnin perusteet</title>
  <meta name="description" content="This repository contains materials used in an introductory level R course at University of Jyväskylä and University of Eastern Finland." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Kappale 5 Datan muokkaaminen | R-ohjelmoinnin perusteet" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This repository contains materials used in an introductory level R course at University of Jyväskylä and University of Eastern Finland." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kappale 5 Datan muokkaaminen | R-ohjelmoinnin perusteet" />
  
  <meta name="twitter:description" content="This repository contains materials used in an introductory level R course at University of Jyväskylä and University of Eastern Finland." />
  

<meta name="author" content="Anton Klåvus (2020), Juho Kopra and Santtu Tikka (2021)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading-data.html"/>
<link rel="next" href="statistics.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.tinyurl.com/rkurssi">R-ohjelmoinnin perusteet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html"><i class="fa fa-check"></i>R-kurssi</a>
<ul>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#ohjeita-verkkokirjan-käyttöön"><i class="fa fa-check"></i>Ohjeita verkkokirjan käyttöön</a></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#lunttilappu"><i class="fa fa-check"></i>Lunttilappu</a></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#verkkolähteitä"><i class="fa fa-check"></i>Verkkolähteitä</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html"><i class="fa fa-check"></i>Alkuvalmistelut</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rn-ja-rstudion-asentaminen-omalle-tietokoneelle"><i class="fa fa-check"></i>R:n ja RStudion asentaminen omalle tietokoneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-asennus-yliopiston-koneelle"><i class="fa fa-check"></i>RStudion asennus yliopiston koneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-käyttö"><i class="fa fa-check"></i>RStudion käyttö</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rcourse-paketin-asentaminen"><i class="fa fa-check"></i>Rcourse-paketin asentaminen</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#r-paketit"><i class="fa fa-check"></i>R-paketit</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#asentaminen"><i class="fa fa-check"></i>Asentaminen</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#opiskelu-ja-tenttiminen-rcourse-paketin-avulla"><i class="fa fa-check"></i>Opiskelu ja tenttiminen Rcourse-paketin avulla</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#tehtävien-tallentaminen-skripteihin-rstudiolla"><i class="fa fa-check"></i>Tehtävien tallentaminen skripteihin RStudiolla</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Johdanto</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what_R"><i class="fa fa-check"></i><b>1.1</b> Mikä R on ja mitä sillä tehdään?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html"><i class="fa fa-check"></i><b>2</b> Muuttujat ja vektorit</a>
<ul>
<li class="chapter" data-level="2.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#variables"><i class="fa fa-check"></i><b>2.1</b> Muuttujat</a></li>
<li class="chapter" data-level="2.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#comments"><i class="fa fa-check"></i><b>2.2</b> Kommentit</a></li>
<li class="chapter" data-level="2.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vectors"><i class="fa fa-check"></i><b>2.3</b> Vektorit</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ei-numeeriset-vektorit"><i class="fa fa-check"></i><b>2.3.1</b> Ei-numeeriset vektorit</a></li>
<li class="chapter" data-level="2.3.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vektorien-indeksointi-ja-osajoukon-valinta"><i class="fa fa-check"></i><b>2.3.2</b> Vektorien indeksointi ja osajoukon valinta</a></li>
<li class="chapter" data-level="2.3.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#puuttuvat-arvot"><i class="fa fa-check"></i><b>2.3.3</b> Puuttuvat arvot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#extra"><i class="fa fa-check"></i><b>2.4</b> Extra: Alkeistietotyypit ja erikoisarvot</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ääretön-ja-miinus-ääretön"><i class="fa fa-check"></i><b>2.4.1</b> Ääretön ja miinus ääretön</a></li>
<li class="chapter" data-level="2.4.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ei-numero"><i class="fa fa-check"></i><b>2.4.2</b> Ei-numero</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3</b> Tietotyypit</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html#data-frame"><i class="fa fa-check"></i><b>3.1</b> Datakehikko (data.frame)</a></li>
<li class="chapter" data-level="3.2" data-path="data-types.html"><a href="data-types.html#matrix"><i class="fa fa-check"></i><b>3.2</b> Matriisi</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-types.html"><a href="data-types.html#matriisin-luominen"><i class="fa fa-check"></i><b>3.2.1</b> Matriisin luominen</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-types.html"><a href="data-types.html#matriisin-koko"><i class="fa fa-check"></i><b>3.2.2</b> Matriisin koko</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-types.html"><a href="data-types.html#matriisin-indeksointi"><i class="fa fa-check"></i><b>3.2.3</b> Matriisin indeksointi</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-types.html"><a href="data-types.html#matriisien-rakentaminen-vektoreista"><i class="fa fa-check"></i><b>3.2.4</b> Matriisien rakentaminen vektoreista</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-types.html"><a href="data-types.html#rivien-ja-sarakkeiden-nimeäminen"><i class="fa fa-check"></i><b>3.2.5</b> Rivien ja sarakkeiden nimeäminen</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-types.html"><a href="data-types.html#matriiseilla-laskeminen"><i class="fa fa-check"></i><b>3.2.6</b> Matriiseilla laskeminen</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-types.html"><a href="data-types.html#data-type-view"><i class="fa fa-check"></i><b>3.3</b> Tietotyyppien tarkastelu</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-types.html"><a href="data-types.html#view"><i class="fa fa-check"></i><b>3.3.1</b> View()</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-types.html"><a href="data-types.html#str"><i class="fa fa-check"></i><b>3.3.2</b> str()</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-types.html"><a href="data-types.html#head"><i class="fa fa-check"></i><b>3.3.3</b> head()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-types.html"><a href="data-types.html#extra-taulukko-ja-lista"><i class="fa fa-check"></i><b>3.4</b> Extra: Taulukko ja lista</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-types.html"><a href="data-types.html#array"><i class="fa fa-check"></i><b>3.4.1</b> Taulukko</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-types.html"><a href="data-types.html#list"><i class="fa fa-check"></i><b>3.4.2</b> Lista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>4</b> Datan lukeminen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reading-data.html"><a href="reading-data.html#hakemistopolut-ja-tiedostopäätteet"><i class="fa fa-check"></i><b>4.1</b> Hakemistopolut ja tiedostopäätteet</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reading-data.html"><a href="reading-data.html#hakemistopolut"><i class="fa fa-check"></i><b>4.1.1</b> Hakemistopolut</a></li>
<li class="chapter" data-level="4.1.2" data-path="reading-data.html"><a href="reading-data.html#tiedostopäätteet"><i class="fa fa-check"></i><b>4.1.2</b> Tiedostopäätteet</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reading-data.html"><a href="reading-data.html#tekstitiedostot"><i class="fa fa-check"></i><b>4.2</b> Tekstitiedostot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-data.html"><a href="reading-data.html#read.table"><i class="fa fa-check"></i><b>4.2.1</b> read.table</a></li>
<li class="chapter" data-level="4.2.2" data-path="reading-data.html"><a href="reading-data.html#read.csv"><i class="fa fa-check"></i><b>4.2.2</b> read.csv</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-data.html"><a href="reading-data.html#datakehikon-tarkastelu"><i class="fa fa-check"></i><b>4.3</b> Datakehikon tarkastelu</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="reading-data.html"><a href="reading-data.html#rn-sisäänrakennetut-datasetit"><i class="fa fa-check"></i><b>4.3.1</b> R:n sisäänrakennetut datasetit</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="reading-data.html"><a href="reading-data.html#muut-tiedostot"><i class="fa fa-check"></i><b>4.4</b> Muut tiedostot</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="reading-data.html"><a href="reading-data.html#excel"><i class="fa fa-check"></i><b>4.4.1</b> Excel</a></li>
<li class="chapter" data-level="4.4.2" data-path="reading-data.html"><a href="reading-data.html#spss"><i class="fa fa-check"></i><b>4.4.2</b> SPSS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Datan muokkaaminen</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame-wrangling"><i class="fa fa-check"></i><b>5.1</b> Uuden muuttujan tai rivin luonti datakehikkoon</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#datakehikon-käsittely"><i class="fa fa-check"></i><b>5.1.1</b> Datakehikon käsittely</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#osajoukkojen-valinta"><i class="fa fa-check"></i><b>5.2</b> Osajoukkojen valinta</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#faktorit"><i class="fa fa-check"></i><b>5.3</b> Faktorit</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#factor-extra"><i class="fa fa-check"></i><b>5.4</b> Extra: Lääketutkimusesimerkki</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>6</b> Tunnusluvut</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistics.html"><a href="statistics.html#sijaintia-kuvaavat-tunnusluvut"><i class="fa fa-check"></i><b>6.1</b> Sijaintia kuvaavat tunnusluvut</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistics.html"><a href="statistics.html#minimi-ja-maksimi"><i class="fa fa-check"></i><b>6.1.1</b> Minimi ja maksimi</a></li>
<li class="chapter" data-level="6.1.2" data-path="statistics.html"><a href="statistics.html#keskiarvo"><i class="fa fa-check"></i><b>6.1.2</b> Keskiarvo</a></li>
<li class="chapter" data-level="6.1.3" data-path="statistics.html"><a href="statistics.html#mediaani"><i class="fa fa-check"></i><b>6.1.3</b> Mediaani</a></li>
<li class="chapter" data-level="6.1.4" data-path="statistics.html"><a href="statistics.html#kvantiilit"><i class="fa fa-check"></i><b>6.1.4</b> Kvantiilit</a></li>
<li class="chapter" data-level="6.1.5" data-path="statistics.html"><a href="statistics.html#moodi"><i class="fa fa-check"></i><b>6.1.5</b> Moodi</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistics.html"><a href="statistics.html#yhteenveto-datasta-summary"><i class="fa fa-check"></i><b>6.2</b> Yhteenveto datasta (summary)</a></li>
<li class="chapter" data-level="6.3" data-path="statistics.html"><a href="statistics.html#varianssi-ja-keskihajonta"><i class="fa fa-check"></i><b>6.3</b> Varianssi ja keskihajonta</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>7</b> Todennäköisyysjakaumat R:ssä</a>
<ul>
<li class="chapter" data-level="7.1" data-path="distributions.html"><a href="distributions.html#esimerkki-normaalijakauma"><i class="fa fa-check"></i><b>7.1</b> Esimerkki: normaalijakauma</a></li>
<li class="chapter" data-level="7.2" data-path="distributions.html"><a href="distributions.html#muita-jakaumia"><i class="fa fa-check"></i><b>7.2</b> Muita jakaumia</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>8</b> Kuvaajien piirtäminen</a>
<ul>
<li class="chapter" data-level="8.1" data-path="plotting.html"><a href="plotting.html#korkean-tason-piirtofunktiot"><i class="fa fa-check"></i><b>8.1</b> Korkean tason piirtofunktiot</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="plotting.html"><a href="plotting.html#plot"><i class="fa fa-check"></i><b>8.1.1</b> plot</a></li>
<li class="chapter" data-level="8.1.2" data-path="plotting.html"><a href="plotting.html#muut-korkean-tason-funktiot"><i class="fa fa-check"></i><b>8.1.2</b> Muut korkean tason funktiot</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="plotting.html"><a href="plotting.html#alemman-tason-grafiikkatoiminnot"><i class="fa fa-check"></i><b>8.2</b> Alemman tason grafiikkatoiminnot</a></li>
<li class="chapter" data-level="8.3" data-path="plotting.html"><a href="plotting.html#kuvaajien-piirtäminen-käytännössä"><i class="fa fa-check"></i><b>8.3</b> Kuvaajien piirtäminen käytännössä</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tests.html"><a href="tests.html"><i class="fa fa-check"></i><b>9</b> Tilastollinen testaaminen</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tests.html"><a href="tests.html#testaamisen-periaatteita"><i class="fa fa-check"></i><b>9.1</b> Testaamisen periaatteita</a></li>
<li class="chapter" data-level="9.2" data-path="tests.html"><a href="tests.html#t-test"><i class="fa fa-check"></i><b>9.2</b> t-testi</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tests.html"><a href="tests.html#yhden-otoksen-t-testi"><i class="fa fa-check"></i><b>9.2.1</b> Yhden otoksen t-testi</a></li>
<li class="chapter" data-level="9.2.2" data-path="tests.html"><a href="tests.html#kahden-otoksen-t-testi"><i class="fa fa-check"></i><b>9.2.2</b> Kahden otoksen t-testi</a></li>
<li class="chapter" data-level="9.2.3" data-path="tests.html"><a href="tests.html#parittaisten-otosten-t-testi"><i class="fa fa-check"></i><b>9.2.3</b> Parittaisten otosten t-testi</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="tests.html"><a href="tests.html#chi-squared-test"><i class="fa fa-check"></i><b>9.3</b> Khiin neliö -testi</a></li>
<li class="chapter" data-level="9.4" data-path="tests.html"><a href="tests.html#anova"><i class="fa fa-check"></i><b>9.4</b> Varianssianalyysi</a></li>
<li class="chapter" data-level="9.5" data-path="tests.html"><a href="tests.html#levene"><i class="fa fa-check"></i><b>9.5</b> Levenen testi</a></li>
<li class="chapter" data-level="9.6" data-path="tests.html"><a href="tests.html#shapiro"><i class="fa fa-check"></i><b>9.6</b> Shapiro-Wilk -testi</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>10</b> Lineaariset mallit</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-models.html"><a href="linear-models.html#teoria"><i class="fa fa-check"></i><b>10.1</b> Teoria</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models.html"><a href="linear-models.html#esimerkki"><i class="fa fa-check"></i><b>10.2</b> Esimerkki</a></li>
<li class="chapter" data-level="10.3" data-path="linear-models.html"><a href="linear-models.html#tarkempia-tietoja-mallista"><i class="fa fa-check"></i><b>10.3</b> Tarkempia tietoja mallista</a></li>
<li class="chapter" data-level="10.4" data-path="linear-models.html"><a href="linear-models.html#ennustaminen"><i class="fa fa-check"></i><b>10.4</b> Ennustaminen</a></li>
<li class="chapter" data-level="10.5" data-path="linear-models.html"><a href="linear-models.html#korrelaatio"><i class="fa fa-check"></i><b>10.5</b> Korrelaatio</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>11</b> Funktiot</a>
<ul>
<li class="chapter" data-level="11.1" data-path="functions.html"><a href="functions.html#funktion-käsite"><i class="fa fa-check"></i><b>11.1</b> Funktion käsite</a></li>
<li class="chapter" data-level="11.2" data-path="functions.html"><a href="functions.html#r-funktiot"><i class="fa fa-check"></i><b>11.2</b> R-funktiot</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="functions.html"><a href="functions.html#funktioiden-määrittely"><i class="fa fa-check"></i><b>11.2.1</b> Funktioiden määrittely</a></li>
<li class="chapter" data-level="11.2.2" data-path="functions.html"><a href="functions.html#argumentit-ja-funktion-kutsuminen"><i class="fa fa-check"></i><b>11.2.2</b> Argumentit ja funktion kutsuminen</a></li>
<li class="chapter" data-level="11.2.3" data-path="functions.html"><a href="functions.html#funktio-ilman-argumentteja"><i class="fa fa-check"></i><b>11.2.3</b> Funktio ilman argumentteja</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="functions.html"><a href="functions.html#palautus-return"><i class="fa fa-check"></i><b>11.3</b> Palautus (return)</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="functions.html"><a href="functions.html#usean-arvon-palautus"><i class="fa fa-check"></i><b>11.3.1</b> Usean arvon palautus</a></li>
<li class="chapter" data-level="11.3.2" data-path="functions.html"><a href="functions.html#palautus-ilman-return-käskyä"><i class="fa fa-check"></i><b>11.3.2</b> Palautus ilman return-käskyä</a></li>
<li class="chapter" data-level="11.3.3" data-path="functions.html"><a href="functions.html#funktio-ilman-tulosta"><i class="fa fa-check"></i><b>11.3.3</b> Funktio ilman tulosta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ifelse.html"><a href="ifelse.html"><i class="fa fa-check"></i><b>12</b> Ehtorakenteet</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ifelse.html"><a href="ifelse.html#loogiset-operaattorit"><i class="fa fa-check"></i><b>12.1</b> Loogiset operaattorit</a></li>
<li class="chapter" data-level="12.2" data-path="ifelse.html"><a href="ifelse.html#ehtorakenteet"><i class="fa fa-check"></i><b>12.2</b> Ehtorakenteet</a></li>
<li class="chapter" data-level="12.3" data-path="ifelse.html"><a href="ifelse.html#alkioiden-poimiminen-vektorista-tietyn-ehdon-perusteella"><i class="fa fa-check"></i><b>12.3</b> Alkioiden poimiminen vektorista tietyn ehdon perusteella</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>13</b> Toistorakenteet (loops)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="loops.html"><a href="loops.html#for-silmukka"><i class="fa fa-check"></i><b>13.1</b> For-silmukka</a></li>
<li class="chapter" data-level="13.2" data-path="loops.html"><a href="loops.html#while-slimukat"><i class="fa fa-check"></i><b>13.2</b> While-slimukat</a></li>
<li class="chapter" data-level="13.3" data-path="loops.html"><a href="loops.html#sisäkkäiset-silmukat-nested-loops"><i class="fa fa-check"></i><b>13.3</b> Sisäkkäiset silmukat (nested loops)</a></li>
<li class="chapter" data-level="13.4" data-path="loops.html"><a href="loops.html#iterointiin-puuttuminen-next-ja-break"><i class="fa fa-check"></i><b>13.4</b> Iterointiin puuttuminen: next ja break</a></li>
<li class="chapter" data-level="13.5" data-path="loops.html"><a href="loops.html#apply-funktiot"><i class="fa fa-check"></i><b>13.5</b> Apply-funktiot</a></li>
<li class="chapter" data-level="13.6" data-path="loops.html"><a href="loops.html#vinkkejä-tehtäviin"><i class="fa fa-check"></i><b>13.6</b> Vinkkejä tehtäviin</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="numerical.html"><a href="numerical.html"><i class="fa fa-check"></i><b>14</b> Numeeriset menetelmät</a>
<ul>
<li class="chapter" data-level="14.1" data-path="numerical.html"><a href="numerical.html#optimointi"><i class="fa fa-check"></i><b>14.1</b> Optimointi</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="numerical.html"><a href="numerical.html#yksi-parametri"><i class="fa fa-check"></i><b>14.1.1</b> Yksi parametri</a></li>
<li class="chapter" data-level="14.1.2" data-path="numerical.html"><a href="numerical.html#useampi-parametri"><i class="fa fa-check"></i><b>14.1.2</b> Useampi parametri</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="numerical.html"><a href="numerical.html#funktion-juurten-etsintä"><i class="fa fa-check"></i><b>14.2</b> Funktion juurten etsintä</a></li>
<li class="chapter" data-level="14.3" data-path="numerical.html"><a href="numerical.html#numeerinen-integrointi"><i class="fa fa-check"></i><b>14.3</b> Numeerinen integrointi</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Julkaistu bookdownilla.</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-ohjelmoinnin perusteet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling" class="section level1" number="5">
<h1><span class="header-section-number">Kappale 5</span> Datan muokkaaminen</h1>
<p>Aineisto ei tyypillisesti ole valmiiksi oikeassa muodossa. Voi olla että halutaan esimerkiksi käyttää vain jotain osajoukkoa aineistosta. Tällöin tarvitaan komentoja aineiston muokkaamiseksi.</p>
<p><strong>Yleinen käytännön vinkki</strong>
Aineiston muokkaaminen (data wrangling) on isojen tutkimusaineistojen kohdalla todella työlästä. Tällöin saatetaan joutua yhdistelemään aineistoja useista lähteistä, etsimään virheellisiä arvoja, muokkaamaan tekstimuotoisia (character) muuttujia eri muotoon ym. Mikäli halutaan muokata tekstimuotoisia vektoreita eri muotoon, niin ne kannattaa muuttaa faktoriksi vasta lopuksi, sillä muuttujan ei ole yleensä tarpeellista olla faktorimuodossa aineistoja muokatessa. Faktorit ovat tyypillisesti tarpeen vasta kun aineistoa aletaan todella analysoimaan.</p>
<div id="data-frame-wrangling" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Uuden muuttujan tai rivin luonti datakehikkoon</h2>
<p>Uusi muuttuja voidaan luoda R:ssä joko perustuen aineiston muihin muuttujiin, tai muuttujan arvot voidaan syöttää vektorina aineistoon. Mikäli uusi muuttuja syötetään lukuina R-koodiin, tulee varmistua siitä, että havaintoja on sama määrä kuin aineistossa on rivejä. Muutoin aineisto tulee syötettyä virheellisesti ja tulokset eivät pidä paikkaansa.</p>
<p>Uuden sarakkeen luonti tapahtuu samalla tavalla kuin jo olemassa olevan sarakkeen muokkaaminen eli dollarisymbolilla, jossa dollarin jälkeen annetaan ensin uuden sarakkeen nimi ja tähän sijoitetaan halutut uuden muuttujan arvot.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-wrangling.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate the number of rows and columns</span></span>
<span id="cb260-2"><a href="data-wrangling.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(study_data)</span></code></pre></div>
<pre><code>## [1] 8 3</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-wrangling.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># there are 8 rows</span></span>
<span id="cb262-2"><a href="data-wrangling.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="data-wrangling.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="co"># initiate a new variable called weight (imput data) with correct number of rows</span></span>
<span id="cb262-4"><a href="data-wrangling.html#cb262-4" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">78.2</span>, <span class="fl">65.8</span>, <span class="fl">49.2</span>, <span class="fl">71.2</span>, <span class="fl">58.3</span>, <span class="fl">54.1</span>, <span class="fl">74.2</span>, <span class="fl">62.8</span>)</span>
<span id="cb262-5"><a href="data-wrangling.html#cb262-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-6"><a href="data-wrangling.html#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a new variable based on existing variables</span></span>
<span id="cb262-7"><a href="data-wrangling.html#cb262-7" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>height_m <span class="ot">&lt;-</span> study_data<span class="sc">$</span>height <span class="sc">/</span> <span class="dv">100</span> <span class="co"># height as metres</span></span>
<span id="cb262-8"><a href="data-wrangling.html#cb262-8" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>BMI <span class="ot">&lt;-</span> study_data<span class="sc">$</span>weight <span class="sc">/</span> (study_data<span class="sc">$</span>height_m<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb262-9"><a href="data-wrangling.html#cb262-9" aria-hidden="true" tabindex="-1"></a>study_data</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 1  1  189.8   male   78.2    1.898   21.70773
## 2  2  184.0 female   65.8    1.840   19.43526
## 3  3  173.8   male   49.2    1.738   16.28792
## 4  4  175.9   male   71.2    1.759   23.01168
## 5  5  169.0 female   58.3    1.690   20.41245
## 6  6  183.7   male   54.1    1.837   16.03168
## 7  7  181.8   male   74.2    1.818   22.44999
## 8  8   16.9 female   62.8    0.169 2198.80256</code></pre>
<div id="datakehikon-käsittely" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Datakehikon käsittely</h3>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-wrangling.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subscripting with variable names</span></span>
<span id="cb264-2"><a href="data-wrangling.html#cb264-2" aria-hidden="true" tabindex="-1"></a>study_data[, <span class="fu">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;gender&quot;</span>)]</span></code></pre></div>
<pre><code>##   height gender
## 1  189.8   male
## 2  184.0 female
## 3  173.8   male
## 4  175.9   male
## 5  169.0 female
## 6  183.7   male
## 7  181.8   male
## 8   16.9 female</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-wrangling.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subscripting with brackets - as matrix (but I do not recommend this style!)</span></span>
<span id="cb266-2"><a href="data-wrangling.html#cb266-2" aria-hidden="true" tabindex="-1"></a>study_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##   ID height
## 1  1  189.8
## 2  2  184.0
## 3  3  173.8
## 4  4  175.9
## 5  5  169.0
## 6  6  183.7
## 7  7  181.8
## 8  8   16.9</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-wrangling.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rownames and colnames</span></span>
<span id="cb268-2"><a href="data-wrangling.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(study_data)</span></code></pre></div>
<pre><code>## [1] &quot;ID&quot;       &quot;height&quot;   &quot;gender&quot;   &quot;weight&quot;   &quot;height_m&quot; &quot;BMI&quot;</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-wrangling.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(study_data)</span></code></pre></div>
<pre><code>## [1] &quot;ID&quot;       &quot;height&quot;   &quot;gender&quot;   &quot;weight&quot;   &quot;height_m&quot; &quot;BMI&quot;</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-wrangling.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual columns can be accessed and added with dollar sign</span></span>
<span id="cb272-2"><a href="data-wrangling.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s say that we find out that the ID number 8 was typed in incorrectly. We can fix the entire height variables as follows</span></span>
<span id="cb272-3"><a href="data-wrangling.html#cb272-3" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">189.8</span>, <span class="fl">184.0</span>, <span class="fl">173.8</span>, <span class="fl">175.9</span>, <span class="fl">169.0</span>, <span class="fl">183.7</span>, <span class="cn">NA</span>, <span class="fl">160.9</span>)</span>
<span id="cb272-4"><a href="data-wrangling.html#cb272-4" aria-hidden="true" tabindex="-1"></a>study_data</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 1  1  189.8   male   78.2    1.898   21.70773
## 2  2  184.0 female   65.8    1.840   19.43526
## 3  3  173.8   male   49.2    1.738   16.28792
## 4  4  175.9   male   71.2    1.759   23.01168
## 5  5  169.0 female   58.3    1.690   20.41245
## 6  6  183.7   male   54.1    1.837   16.03168
## 7  7     NA   male   74.2    1.818   22.44999
## 8  8  160.9 female   62.8    0.169 2198.80256</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="data-wrangling.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It would have been possible to change value of only one cell e.g. like this</span></span>
<span id="cb274-2"><a href="data-wrangling.html#cb274-2" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>height[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fl">161.9</span></span>
<span id="cb274-3"><a href="data-wrangling.html#cb274-3" aria-hidden="true" tabindex="-1"></a>study_data</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 1  1  189.8   male   78.2    1.898   21.70773
## 2  2  184.0 female   65.8    1.840   19.43526
## 3  3  173.8   male   49.2    1.738   16.28792
## 4  4  175.9   male   71.2    1.759   23.01168
## 5  5  169.0 female   58.3    1.690   20.41245
## 6  6  183.7   male   54.1    1.837   16.03168
## 7  7     NA   male   74.2    1.818   22.44999
## 8  8  161.9 female   62.8    0.169 2198.80256</code></pre>
<p>Uuden rivin lisäys datakehikkoon on hieman monimutkaisempaa kuin uuden rivin lisääminen matriisiin, sillä ensin pitää tehdä uusi datakehikko, jolla on samat sarakkeet kuin alkuperäisellä (samassa järjestyksessä), ja vasta sitten liittää se komennolla <code>rbind</code>. Käyttäjän tulee myös huolehtia siitä, että sarakkeet ovat samaa tyyppiä kuin alkuperäisessä datakehikossa.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="data-wrangling.html#cb276-1" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">182</span>, <span class="at">gender =</span> <span class="st">&quot;male&quot;</span>, </span>
<span id="cb276-2"><a href="data-wrangling.html#cb276-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight =</span> <span class="fl">81.2</span>, <span class="at">height_m =</span> <span class="fl">1.82</span>, <span class="at">BMI =</span> <span class="fl">81.2</span> <span class="sc">/</span> <span class="fl">1.82</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb276-3"><a href="data-wrangling.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(study_data, new_row)</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 1  1  189.8   male   78.2    1.898   21.70773
## 2  2  184.0 female   65.8    1.840   19.43526
## 3  3  173.8   male   49.2    1.738   16.28792
## 4  4  175.9   male   71.2    1.759   23.01168
## 5  5  169.0 female   58.3    1.690   20.41245
## 6  6  183.7   male   54.1    1.837   16.03168
## 7  7     NA   male   74.2    1.818   22.44999
## 8  8  161.9 female   62.8    0.169 2198.80256
## 9 11  182.0   male   81.2    1.820   24.51395</code></pre>
</div>
</div>
<div id="osajoukkojen-valinta" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Osajoukkojen valinta</h2>
<p>Aineistosta voi poimia osajoukon hakasulkujen avulla indeksoimalla. Osajoukon poimintaan tarvitaan usein vertailuoperattoreita, ja jos kriteerejä on useita, niin tarvitaan myös useita loogisia operaattoreita. Tarkemmin operaattoreita käsitellään luvussa <a href="ifelse.html#loogiset-operaattorit">Loogiset operaattorit</a>. Voit käyttää kyseisen osion taulukkoa apuna jo tässä osiossa.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="data-wrangling.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only females</span></span>
<span id="cb278-2"><a href="data-wrangling.html#cb278-2" aria-hidden="true" tabindex="-1"></a>study_data[study_data<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&quot;female&quot;</span>, ]</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 2  2  184.0 female   65.8    1.840   19.43526
## 5  5  169.0 female   58.3    1.690   20.41245
## 8  8  161.9 female   62.8    0.169 2198.80256</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="data-wrangling.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter individuals whose height is less than or equal to 175</span></span>
<span id="cb280-2"><a href="data-wrangling.html#cb280-2" aria-hidden="true" tabindex="-1"></a>study_data[study_data<span class="sc">$</span>height <span class="sc">&lt;=</span> <span class="dv">175</span>, ]</span></code></pre></div>
<pre><code>##    ID height gender weight height_m        BMI
## 3   3  173.8   male   49.2    1.738   16.28792
## 5   5  169.0 female   58.3    1.690   20.41245
## NA NA     NA   &lt;NA&gt;     NA       NA         NA
## 8   8  161.9 female   62.8    0.169 2198.80256</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="data-wrangling.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter individuals whose height is not missing and is less than or equal to 175</span></span>
<span id="cb282-2"><a href="data-wrangling.html#cb282-2" aria-hidden="true" tabindex="-1"></a>study_data[<span class="sc">!</span><span class="fu">is.na</span>(study_data<span class="sc">$</span>height) <span class="sc">&amp;</span> study_data<span class="sc">$</span>height <span class="sc">&lt;=</span> <span class="dv">175</span>, ]</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 3  3  173.8   male   49.2    1.738   16.28792
## 5  5  169.0 female   58.3    1.690   20.41245
## 8  8  161.9 female   62.8    0.169 2198.80256</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="data-wrangling.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use multiple filter criteria</span></span>
<span id="cb284-2"><a href="data-wrangling.html#cb284-2" aria-hidden="true" tabindex="-1"></a>study_data[study_data<span class="sc">$</span>height <span class="sc">&lt;=</span> <span class="dv">175</span> <span class="sc">&amp;</span> study_data<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&quot;female&quot;</span>, ]</span></code></pre></div>
<pre><code>##   ID height gender weight height_m        BMI
## 5  5  169.0 female   58.3    1.690   20.41245
## 8  8  161.9 female   62.8    0.169 2198.80256</code></pre>
</div>
<div id="faktorit" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Faktorit</h2>
<p>R:n numeeriset vektorit ovat lähtökohtaisesti jatkuva-asteikollisia. Olet ehkä ihmetellytkin, miten kategorinen muuttuja määritellään. Kategorista muuttujaa sanotaan R:ssä faktoriksi. Numeerisen tai tekstimuotoisen muuttujan tai vektorin voi muuttaa faktori-muotoiseksi muuttujaksi <code>factor</code> -funktiolla.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="data-wrangling.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s change gender from character string to a factor and rename it as fgender</span></span>
<span id="cb286-2"><a href="data-wrangling.html#cb286-2" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>fgender <span class="ot">&lt;-</span> <span class="fu">factor</span>(study_data<span class="sc">$</span>gender)</span>
<span id="cb286-3"><a href="data-wrangling.html#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="data-wrangling.html#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s now compare the printing of gender and fgender</span></span>
<span id="cb286-5"><a href="data-wrangling.html#cb286-5" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>gender</span></code></pre></div>
<pre><code>## [1] &quot;male&quot;   &quot;female&quot; &quot;male&quot;   &quot;male&quot;   &quot;female&quot; &quot;male&quot;   &quot;male&quot;   &quot;female&quot;</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="data-wrangling.html#cb288-1" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>fgender</span></code></pre></div>
<pre><code>## [1] male   female male   male   female male   male   female
## Levels: female male</code></pre>
<p>Huomataan, että faktori tulostaa faktorin tasot eli kaikkien mahdollisten luokkien nimet faktorin perässä: <code>Levels: female male</code>.</p>
<p>Usein vastaan tulee myös tilanne, jossa faktorin eri tasoja vastaavat kokonaislukuarvot, kuten tässä esimerkissä luvut 1, 2 ja 3. Tällaisessa tilanteessa faktorin tasojen merkitys on usein annettu jossain dokumenttitiedostossa. Tällöin faktorin tasot ja niiden kuvaukset (labels) tulee määrittää käsin.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="data-wrangling.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data for this example</span></span>
<span id="cb290-2"><a href="data-wrangling.html#cb290-2" aria-hidden="true" tabindex="-1"></a>wall_dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">building_ID =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">building_material =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb290-3"><a href="data-wrangling.html#cb290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-4"><a href="data-wrangling.html#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Name is &#39;building_material&#39; very long, I want to rename it</span></span>
<span id="cb290-5"><a href="data-wrangling.html#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(wall_dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;building_ID&quot;</span>, <span class="st">&quot;build_mat&quot;</span>)</span>
<span id="cb290-6"><a href="data-wrangling.html#cb290-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-7"><a href="data-wrangling.html#cb290-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We know from some kind of documentation that 1 stands for &quot;wood&quot;, 2 is &quot;steel&quot; and 3 is &quot;brick&quot;.</span></span>
<span id="cb290-8"><a href="data-wrangling.html#cb290-8" aria-hidden="true" tabindex="-1"></a>wall_dat<span class="sc">$</span>fbuild_mat <span class="ot">&lt;-</span> <span class="fu">factor</span>(wall_dat<span class="sc">$</span>build_mat,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;wood&quot;</span>, <span class="st">&quot;steel&quot;</span>, <span class="st">&quot;brick&quot;</span>))</span>
<span id="cb290-9"><a href="data-wrangling.html#cb290-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-10"><a href="data-wrangling.html#cb290-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wall_dat)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    6 obs. of  3 variables:
##  $ building_ID: num  1 2 3 4 5 6
##  $ build_mat  : num  1 1 2 2 3 3
##  $ fbuild_mat : Factor w/ 3 levels &quot;wood&quot;,&quot;steel&quot;,..: 1 1 2 2 3 3</code></pre>
</div>
<div id="factor-extra" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Extra: Lääketutkimusesimerkki</h2>
<p>R:ssä on aiemmin nähtyjen numeric, character ja logical-vektorien lisäksi muitakin vektoriluokkia, tärkeimpänä näistä factor. Factor-vektoreihin tallennetaan kategorisia muuttujia, kuten tutkimuksessa määrättyjä ryhmiä, aikapisteitä tms. Luodaan esimerkiksi factor-vektori, jossa on kuvitteellisen lääketutkimuksen osallistujien ryhmätiedot:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="data-wrangling.html#cb292-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;drug1&quot;</span>, <span class="st">&quot;drug2&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;drug1&quot;</span>, <span class="st">&quot;control&quot;</span>,</span>
<span id="cb292-2"><a href="data-wrangling.html#cb292-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;drug2&quot;</span>, <span class="st">&quot;drug2&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;drug1&quot;</span>))</span>
<span id="cb292-3"><a href="data-wrangling.html#cb292-3" aria-hidden="true" tabindex="-1"></a>groups</span></code></pre></div>
<pre><code>##  [1] drug1   drug2   control drug1   control drug2   drug2   control control
## [10] drug1  
## Levels: control drug1 drug2</code></pre>
<p>Factoreita voi luoda muista vektoreista funktioilla <code>factor</code> tai <code>as.factor</code>. <code>as.factor</code> muuntaa vektorin automaattisesti ja nopeasti factoriksi, ja säilyttää myös jo valmiiksi factor-luokan vektorien tasojen järjestyksen (tästä lisää pian).</p>
<p>Kuten tulosteesta nähdään, factor-vektorin tulostus tulostaa factorin alkiot (HUOM: ei lainausmerkkejä) sekä factorin tasot. Factorit ovat pinnan alla kokonaisluku- eli integer-vektoreita, joissa on päällä “kerros”, joka määrittää factorin tasot. Edellä nähty vektori groups näyttää siis tältä:</p>
<p><img src="files/05-statistics/factor.png" /></p>
<p>Factorien tasoille annetaan siis lukuarvot ykkösestä eteenpäin. Oletuksena ensimmäinen taso eli taso 1 on aakkosissa ensimmäinen arvo, tai pienin lukuarvo jos factori tehdään numeerisista muuttujista. Lukuarvot saa näkyville muuntamalla factorin numeeriseksi vektoriksi:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="data-wrangling.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(groups)</span></code></pre></div>
<pre><code>##  [1] 2 3 1 2 1 3 3 1 1 2</code></pre>
<p>Tasojen järjestyksen voi myös päättää itse. Tämä on tärkeää, sillä kuten pian nähdään, factorin ensimmäinen taso on monissa tilastollisissa testeissä ns. referenssitaso, johon muita tasoja verrataan. Usein esiintyvä tapaus ovat tutkimukset, joissa on ryhmät nimeltä case ja control. Koska case on aakkosissa ennen controllia, R käyttää oletuksen case-ryhmää referenssitasona, ja testaa miten control-ryhmä poikkeaa tästä tasosta, vaikka haluaisimme päinvastaisen tuloksen. Tasot voi itse määrittää näin:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="data-wrangling.html#cb296-1" aria-hidden="true" tabindex="-1"></a>study_groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>, <span class="st">&quot;case&quot;</span>),</span>
<span id="cb296-2"><a href="data-wrangling.html#cb296-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>))</span>
<span id="cb296-3"><a href="data-wrangling.html#cb296-3" aria-hidden="true" tabindex="-1"></a>study_groups</span></code></pre></div>
<pre><code>## [1] case    control control case    case   
## Levels: control case</code></pre>
<p>Nyt tasot ovat oikeassa järjestyksessä!</p>
<p>Kuten aiemmin mainittiin, factoreita voi tehdä myös numeerisista vektoreista. HUOM: muista, että <code>as.numeric()</code> palauttaa factorin kokonaislukuarvot, ei alkuperäisiä lukuja. Alkuperäiset luvut saa käyttämällä ensin <code>as.character</code>-funktiota, joka muuttaa factorin tasot merkkijonovektoriksi.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="data-wrangling.html#cb298-1" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb298-2"><a href="data-wrangling.html#cb298-2" aria-hidden="true" tabindex="-1"></a>time_points</span></code></pre></div>
<pre><code>## [1] 0 0 1 1 5 5 1 0 5
## Levels: 0 1 5</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="data-wrangling.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probably not what you expect</span></span>
<span id="cb300-2"><a href="data-wrangling.html#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(time_points)</span></code></pre></div>
<pre><code>## [1] 1 1 2 2 3 3 2 1 3</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="data-wrangling.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First to character, then to numeric</span></span>
<span id="cb302-2"><a href="data-wrangling.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(time_points))</span></code></pre></div>
<pre><code>## [1] 0 0 1 1 5 5 1 0 5</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reading-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-ohjelmoinnin-perusteet.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

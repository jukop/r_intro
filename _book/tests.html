<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kappale 9 Tilastollinen testaaminen | R-ohjelmoinnin perusteet</title>
  <meta name="description" content="This repository contains materials used in an introductory level R course at University of Jyväskylä and University of Eastern Finland." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Kappale 9 Tilastollinen testaaminen | R-ohjelmoinnin perusteet" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This repository contains materials used in an introductory level R course at University of Jyväskylä and University of Eastern Finland." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kappale 9 Tilastollinen testaaminen | R-ohjelmoinnin perusteet" />
  
  <meta name="twitter:description" content="This repository contains materials used in an introductory level R course at University of Jyväskylä and University of Eastern Finland." />
  

<meta name="author" content="Anton Klåvus (2020), converted to bookdown by Juho Kopra and Santtu Tikka (2021)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting.html"/>
<link rel="next" href="linear-models.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-ohjelmoinnin perusteet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html"><i class="fa fa-check"></i>R-kurssi</a>
<ul>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#ohjeita-verkkokirjan-käyttöön"><i class="fa fa-check"></i>Ohjeita verkkokirjan käyttöön</a></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#lunttilappu"><i class="fa fa-check"></i>Lunttilappu</a></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#verkkolähteitä"><i class="fa fa-check"></i>Verkkolähteitä</a></li>
<li class="chapter" data-level="" data-path="r-kurssi.html"><a href="r-kurssi.html#sisällysluettelo"><i class="fa fa-check"></i>Sisällysluettelo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html"><i class="fa fa-check"></i>Alkuvalmistelut</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rn-ja-rstudion-asentaminen-omalle-tietokoneelle"><i class="fa fa-check"></i>R:n ja RStudion asentaminen omalle tietokoneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-asennus-yliopiston-koneelle"><i class="fa fa-check"></i>RStudion asennus yliopiston koneelle</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rstudion-käyttö"><i class="fa fa-check"></i>RStudion käyttö</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#rcourse-paketin-asentaminen"><i class="fa fa-check"></i>Rcourse-paketin asentaminen</a>
<ul>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#r-paketit"><i class="fa fa-check"></i>R-paketit</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#asentaminen"><i class="fa fa-check"></i>Asentaminen</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#opiskelu-ja-tenttiminen-rcourse-paketin-avulla"><i class="fa fa-check"></i>Opiskelu ja tenttiminen Rcourse-paketin avulla</a></li>
<li class="chapter" data-level="" data-path="alkuvalmistelut.html"><a href="alkuvalmistelut.html#tehtävien-tallentaminen-skripteihin-rstudiolla"><i class="fa fa-check"></i>Tehtävien tallentaminen skripteihin RStudiolla</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Johdanto</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what_R"><i class="fa fa-check"></i><b>1.1</b> Mikä R on ja mitä sillä tehdään?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html"><i class="fa fa-check"></i><b>2</b> Muuttujat ja vektorit</a>
<ul>
<li class="chapter" data-level="2.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#variables"><i class="fa fa-check"></i><b>2.1</b> Muuttujat</a></li>
<li class="chapter" data-level="2.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#comments"><i class="fa fa-check"></i><b>2.2</b> Kommentit</a></li>
<li class="chapter" data-level="2.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vectors"><i class="fa fa-check"></i><b>2.3</b> Vektorit</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ei-numeeriset-vektorit"><i class="fa fa-check"></i><b>2.3.1</b> Ei-numeeriset vektorit</a></li>
<li class="chapter" data-level="2.3.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vektorien-indeksointi-ja-osajoukon-valinta"><i class="fa fa-check"></i><b>2.3.2</b> Vektorien indeksointi ja osajoukon valinta</a></li>
<li class="chapter" data-level="2.3.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#puuttuvat-arvot"><i class="fa fa-check"></i><b>2.3.3</b> Puuttuvat arvot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#extra"><i class="fa fa-check"></i><b>2.4</b> Extra: Alkeistietotyypit ja erikoisarvot</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ääretön-ja-miinus-ääretön"><i class="fa fa-check"></i><b>2.4.1</b> Ääretön ja miinus ääretön</a></li>
<li class="chapter" data-level="2.4.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#ei-numero"><i class="fa fa-check"></i><b>2.4.2</b> Ei-numero</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3</b> Tietotyypit</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html#data-frame"><i class="fa fa-check"></i><b>3.1</b> Datakehikko (data.frame)</a></li>
<li class="chapter" data-level="3.2" data-path="data-types.html"><a href="data-types.html#matrix"><i class="fa fa-check"></i><b>3.2</b> Matriisi</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-types.html"><a href="data-types.html#matriisin-luominen"><i class="fa fa-check"></i><b>3.2.1</b> Matriisin luominen</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-types.html"><a href="data-types.html#matriisin-koko"><i class="fa fa-check"></i><b>3.2.2</b> Matriisin koko</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-types.html"><a href="data-types.html#matriisin-indeksointi"><i class="fa fa-check"></i><b>3.2.3</b> Matriisin indeksointi</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-types.html"><a href="data-types.html#matriisien-rakentaminen-vektoreista"><i class="fa fa-check"></i><b>3.2.4</b> Matriisien rakentaminen vektoreista</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-types.html"><a href="data-types.html#rivien-ja-sarakkeiden-nimeäminen"><i class="fa fa-check"></i><b>3.2.5</b> Rivien ja sarakkeiden nimeäminen</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-types.html"><a href="data-types.html#matriiseilla-laskeminen"><i class="fa fa-check"></i><b>3.2.6</b> Matriiseilla laskeminen</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-types.html"><a href="data-types.html#data-type-view"><i class="fa fa-check"></i><b>3.3</b> Tietotyyppien tarkastelu</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-types.html"><a href="data-types.html#view"><i class="fa fa-check"></i><b>3.3.1</b> View()</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-types.html"><a href="data-types.html#str"><i class="fa fa-check"></i><b>3.3.2</b> str()</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-types.html"><a href="data-types.html#head"><i class="fa fa-check"></i><b>3.3.3</b> head()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-types.html"><a href="data-types.html#extra-taulukko-ja-lista"><i class="fa fa-check"></i><b>3.4</b> Extra: Taulukko ja lista</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-types.html"><a href="data-types.html#array"><i class="fa fa-check"></i><b>3.4.1</b> Taulukko</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-types.html"><a href="data-types.html#list"><i class="fa fa-check"></i><b>3.4.2</b> Lista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>4</b> Datan lukeminen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reading-data.html"><a href="reading-data.html#tekstitiedostot"><i class="fa fa-check"></i><b>4.1</b> Tekstitiedostot</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reading-data.html"><a href="reading-data.html#read.table"><i class="fa fa-check"></i><b>4.1.1</b> read.table</a></li>
<li class="chapter" data-level="4.1.2" data-path="reading-data.html"><a href="reading-data.html#read.csv"><i class="fa fa-check"></i><b>4.1.2</b> read.csv</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reading-data.html"><a href="reading-data.html#datakehikon-tarkastelu"><i class="fa fa-check"></i><b>4.2</b> Datakehikon tarkastelu</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-data.html"><a href="reading-data.html#rn-sisäänrakennetut-datasetit"><i class="fa fa-check"></i><b>4.2.1</b> R:n sisäänrakennetut datasetit</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reading-data.html"><a href="reading-data.html#muut-tiedostot"><i class="fa fa-check"></i><b>4.3</b> Muut tiedostot</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="reading-data.html"><a href="reading-data.html#excel"><i class="fa fa-check"></i><b>4.3.1</b> Excel</a></li>
<li class="chapter" data-level="4.3.2" data-path="reading-data.html"><a href="reading-data.html#spss"><i class="fa fa-check"></i><b>4.3.2</b> SPSS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Datan muokkaaminen</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame-wrangling"><i class="fa fa-check"></i><b>5.1</b> Uuden muuttujan tai rivin luonti datakehikkoon</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#datakehikon-käsittely"><i class="fa fa-check"></i><b>5.1.1</b> Datakehikon käsittely</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#osajoukkojen-valinta"><i class="fa fa-check"></i><b>5.2</b> Osajoukkojen valinta</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#faktorit"><i class="fa fa-check"></i><b>5.3</b> Faktorit</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#factor-extra"><i class="fa fa-check"></i><b>5.4</b> Extra: Lääketutkimusesimerkki</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>6</b> Tunnusluvut</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistics.html"><a href="statistics.html#sijaintia-kuvaavat-tunnusluvut"><i class="fa fa-check"></i><b>6.1</b> Sijaintia kuvaavat tunnusluvut</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistics.html"><a href="statistics.html#minimi-ja-maksimi"><i class="fa fa-check"></i><b>6.1.1</b> Minimi ja maksimi</a></li>
<li class="chapter" data-level="6.1.2" data-path="statistics.html"><a href="statistics.html#keskiarvo"><i class="fa fa-check"></i><b>6.1.2</b> Keskiarvo</a></li>
<li class="chapter" data-level="6.1.3" data-path="statistics.html"><a href="statistics.html#mediaani"><i class="fa fa-check"></i><b>6.1.3</b> Mediaani</a></li>
<li class="chapter" data-level="6.1.4" data-path="statistics.html"><a href="statistics.html#kvantiilit"><i class="fa fa-check"></i><b>6.1.4</b> Kvantiilit</a></li>
<li class="chapter" data-level="6.1.5" data-path="statistics.html"><a href="statistics.html#moodi"><i class="fa fa-check"></i><b>6.1.5</b> Moodi</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistics.html"><a href="statistics.html#yhteenveto-datasta-summary"><i class="fa fa-check"></i><b>6.2</b> Yhteenveto datasta (summary)</a></li>
<li class="chapter" data-level="6.3" data-path="statistics.html"><a href="statistics.html#varianssi-ja-keskihajonta"><i class="fa fa-check"></i><b>6.3</b> Varianssi ja keskihajonta</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>7</b> Todennäköisyysjakaumat R:ssä</a>
<ul>
<li class="chapter" data-level="7.1" data-path="distributions.html"><a href="distributions.html#esimerkki-normaalijakauma"><i class="fa fa-check"></i><b>7.1</b> Esimerkki: normaalijakauma</a></li>
<li class="chapter" data-level="7.2" data-path="distributions.html"><a href="distributions.html#muita-jakaumia"><i class="fa fa-check"></i><b>7.2</b> Muita jakaumia</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>8</b> Kuvaajien piirtäminen</a>
<ul>
<li class="chapter" data-level="8.1" data-path="plotting.html"><a href="plotting.html#korkean-tason-piirtofunktiot"><i class="fa fa-check"></i><b>8.1</b> Korkean tason piirtofunktiot</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="plotting.html"><a href="plotting.html#plot"><i class="fa fa-check"></i><b>8.1.1</b> plot</a></li>
<li class="chapter" data-level="8.1.2" data-path="plotting.html"><a href="plotting.html#muut-korkean-tason-funktiot"><i class="fa fa-check"></i><b>8.1.2</b> Muut korkean tason funktiot</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="plotting.html"><a href="plotting.html#alemman-tason-grafiikkatoiminnot"><i class="fa fa-check"></i><b>8.2</b> Alemman tason grafiikkatoiminnot</a></li>
<li class="chapter" data-level="8.3" data-path="plotting.html"><a href="plotting.html#kuvaajien-piirtäminen-käytännössä"><i class="fa fa-check"></i><b>8.3</b> Kuvaajien piirtäminen käytännössä</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tests.html"><a href="tests.html"><i class="fa fa-check"></i><b>9</b> Tilastollinen testaaminen</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tests.html"><a href="tests.html#testaamisen-periaatteita"><i class="fa fa-check"></i><b>9.1</b> Testaamisen periaatteita</a></li>
<li class="chapter" data-level="9.2" data-path="tests.html"><a href="tests.html#t-test"><i class="fa fa-check"></i><b>9.2</b> t-testi</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tests.html"><a href="tests.html#yhden-otoksen-t-testi"><i class="fa fa-check"></i><b>9.2.1</b> Yhden otoksen t-testi</a></li>
<li class="chapter" data-level="9.2.2" data-path="tests.html"><a href="tests.html#kahden-otoksen-t-testi"><i class="fa fa-check"></i><b>9.2.2</b> Kahden otoksen t-testi</a></li>
<li class="chapter" data-level="9.2.3" data-path="tests.html"><a href="tests.html#parittaisten-otosten-t-testi"><i class="fa fa-check"></i><b>9.2.3</b> Parittaisten otosten t-testi</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="tests.html"><a href="tests.html#chi-squared-test"><i class="fa fa-check"></i><b>9.3</b> Khiin neliö -testi</a></li>
<li class="chapter" data-level="9.4" data-path="tests.html"><a href="tests.html#anova"><i class="fa fa-check"></i><b>9.4</b> Varianssianalyysi</a></li>
<li class="chapter" data-level="9.5" data-path="tests.html"><a href="tests.html#levene"><i class="fa fa-check"></i><b>9.5</b> Levenen testi</a></li>
<li class="chapter" data-level="9.6" data-path="tests.html"><a href="tests.html#shapiro"><i class="fa fa-check"></i><b>9.6</b> Shapiro-Wilk -testi</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>10</b> Lineaariset mallit</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-models.html"><a href="linear-models.html#teoria"><i class="fa fa-check"></i><b>10.1</b> Teoria</a></li>
<li class="chapter" data-level="10.2" data-path="linear-models.html"><a href="linear-models.html#esimerkki"><i class="fa fa-check"></i><b>10.2</b> Esimerkki</a></li>
<li class="chapter" data-level="10.3" data-path="linear-models.html"><a href="linear-models.html#tarkempia-tietoja-mallista"><i class="fa fa-check"></i><b>10.3</b> Tarkempia tietoja mallista</a></li>
<li class="chapter" data-level="10.4" data-path="linear-models.html"><a href="linear-models.html#ennustaminen"><i class="fa fa-check"></i><b>10.4</b> Ennustaminen</a></li>
<li class="chapter" data-level="10.5" data-path="linear-models.html"><a href="linear-models.html#korrelaatio"><i class="fa fa-check"></i><b>10.5</b> Korrelaatio</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>11</b> Funktiot</a>
<ul>
<li class="chapter" data-level="11.1" data-path="functions.html"><a href="functions.html#funktion-käsite"><i class="fa fa-check"></i><b>11.1</b> Funktion käsite</a></li>
<li class="chapter" data-level="11.2" data-path="functions.html"><a href="functions.html#r-funktiot"><i class="fa fa-check"></i><b>11.2</b> R-funktiot</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="functions.html"><a href="functions.html#funktioiden-määrittely"><i class="fa fa-check"></i><b>11.2.1</b> Funktioiden määrittely</a></li>
<li class="chapter" data-level="11.2.2" data-path="functions.html"><a href="functions.html#argumentit-ja-funktion-kutsuminen"><i class="fa fa-check"></i><b>11.2.2</b> Argumentit ja funktion kutsuminen</a></li>
<li class="chapter" data-level="11.2.3" data-path="functions.html"><a href="functions.html#funktio-ilman-argumentteja"><i class="fa fa-check"></i><b>11.2.3</b> Funktio ilman argumentteja</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="functions.html"><a href="functions.html#palautus-return"><i class="fa fa-check"></i><b>11.3</b> Palautus (return)</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="functions.html"><a href="functions.html#usean-arvon-palautus"><i class="fa fa-check"></i><b>11.3.1</b> Usean arvon palautus</a></li>
<li class="chapter" data-level="11.3.2" data-path="functions.html"><a href="functions.html#palautus-ilman-return-käskyä"><i class="fa fa-check"></i><b>11.3.2</b> Palautus ilman return-käskyä</a></li>
<li class="chapter" data-level="11.3.3" data-path="functions.html"><a href="functions.html#funktio-ilman-tulosta"><i class="fa fa-check"></i><b>11.3.3</b> Funktio ilman tulosta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ifelse.html"><a href="ifelse.html"><i class="fa fa-check"></i><b>12</b> Ehtorakenteet</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ifelse.html"><a href="ifelse.html#loogiset-operaattorit"><i class="fa fa-check"></i><b>12.1</b> Loogiset operaattorit</a></li>
<li class="chapter" data-level="12.2" data-path="ifelse.html"><a href="ifelse.html#ehtorakenteet"><i class="fa fa-check"></i><b>12.2</b> Ehtorakenteet</a></li>
<li class="chapter" data-level="12.3" data-path="ifelse.html"><a href="ifelse.html#alkioiden-poimiminen-vektorista-tietyn-ehdon-perusteella"><i class="fa fa-check"></i><b>12.3</b> Alkioiden poimiminen vektorista tietyn ehdon perusteella</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>13</b> Toistorakenteet (loops)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="loops.html"><a href="loops.html#for-silmukka"><i class="fa fa-check"></i><b>13.1</b> For-silmukka</a></li>
<li class="chapter" data-level="13.2" data-path="loops.html"><a href="loops.html#while-slimukat"><i class="fa fa-check"></i><b>13.2</b> While-slimukat</a></li>
<li class="chapter" data-level="13.3" data-path="loops.html"><a href="loops.html#sisäkkäiset-silmukat-nested-loops"><i class="fa fa-check"></i><b>13.3</b> Sisäkkäiset silmukat (nested loops)</a></li>
<li class="chapter" data-level="13.4" data-path="loops.html"><a href="loops.html#iterointiin-puuttuminen-next-ja-break"><i class="fa fa-check"></i><b>13.4</b> Iterointiin puuttuminen: next ja break</a></li>
<li class="chapter" data-level="13.5" data-path="loops.html"><a href="loops.html#apply-funktiot"><i class="fa fa-check"></i><b>13.5</b> Apply-funktiot</a></li>
<li class="chapter" data-level="13.6" data-path="loops.html"><a href="loops.html#vinkkejä-tehtäviin"><i class="fa fa-check"></i><b>13.6</b> Vinkkejä tehtäviin</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="numerical.html"><a href="numerical.html"><i class="fa fa-check"></i><b>14</b> Numeeriset menetelmät</a>
<ul>
<li class="chapter" data-level="14.1" data-path="numerical.html"><a href="numerical.html#optimointi"><i class="fa fa-check"></i><b>14.1</b> Optimointi</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="numerical.html"><a href="numerical.html#yksi-parametri"><i class="fa fa-check"></i><b>14.1.1</b> Yksi parametri</a></li>
<li class="chapter" data-level="14.1.2" data-path="numerical.html"><a href="numerical.html#useampi-parametri"><i class="fa fa-check"></i><b>14.1.2</b> Useampi parametri</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="numerical.html"><a href="numerical.html#funktion-juurten-etsintä"><i class="fa fa-check"></i><b>14.2</b> Funktion juurten etsintä</a></li>
<li class="chapter" data-level="14.3" data-path="numerical.html"><a href="numerical.html#numeerinen-integrointi"><i class="fa fa-check"></i><b>14.3</b> Numeerinen integrointi</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Julkaistu bookdownilla.</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-ohjelmoinnin perusteet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tests" class="section level1" number="9">
<h1><span class="header-section-number">Kappale 9</span> Tilastollinen testaaminen</h1>
<div id="testaamisen-periaatteita" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Testaamisen periaatteita</h2>
<p>Tilastollisilla testeillä pyritään arvioimaan perusjoukkoa koskevien väiteiden paikkansapitävyyttä todennäköisyyslaskennan keinoin. Lähtökohtana on niin sanottu <strong>nollahypoteesi</strong> (<span class="math inline">\(H_0\)</span>), joka yleensä vastaa tilannetta, jossa mahdolliset väitettä tukevat haivainnot ovat vain sattuman seurausta. Esimerkiksi jos tutkitaan onko jokin lääkeaine tehokas hoitokeino, voisi nollahypoteesi olla muotoa “ei vaikutusta”. Nollahypoteesiin liittyy aina <strong>vastahypoteesi</strong> (<span class="math inline">\(H_1\)</span>), joka yleensä nollahypoteesin vastakohta, ja vastaa mielenkiinnon kohteena olevaa väitettä (esim. “on vaikutusta”).</p>
<p>Tilastolliset testit olettava nollahypoteesin olevan totta, jolloin epäuskottavat tulokset antavat aihetta epäillä nollahypoteesin mielekkyyttä. Testiin liittyy yleensä <strong>testisuure</strong>, joka on jokin aineistosta laskettu tunnusluku. Testisuureen jakauman perusteella voidaan arvioida todennäköisyyttä, että havaittu tulos olisi vain sattuman seurausta. Tätä todennäköisyyttä kutsutaan <strong>p-arvoksi</strong>. Perinteisesti tilastotieteessä asetetaan etukäteen jokin riskitaso (<span class="math inline">\(\alpha\)</span>), ja jos saatu p-arvo on riskitasoa pienempi niin nollahypoteesi hylätään (yleensä <span class="math inline">\(\alpha = 0.05\)</span>). Jos p-arvo on riskitasoa pienempi, niin havaintoa kutsutaan tilastollisesti merkitseväksi.</p>
</div>
<div id="t-test" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> t-testi</h2>
<p>Studentin t-testi on yksi tunnetuimmista tilastollisista testeistä. Se testaa muuttujien odotusarvoja.</p>
<p>Tarkastellaan R:n sisäistä dataa <code>sleep</code>, joka sisältää muutoksia oppilaiden unen määrässä (muuttuja <code>extra</code>, muutos unen määrässä tunneissa) kahdella eri lääkkeellä (muuttuja <code>group</code>). Jokainen oppilas kokeili kumpaakin lääkettä, muuttuja <code>ID</code> yksilöi oppilaat.</p>
<div id="yhden-otoksen-t-testi" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Yhden otoksen t-testi</h3>
<p>Testaamme aluksi hypoteesia, että muutos unen määrässä lääkkeen käytön jälkeen on 0 (<span class="math inline">\(H_0 : \mu = 0\)</span>). Funktiota <code>t.test</code> voi käyttää monella tapaa. Tässä esimerkissä annamme funktiolle kaavan <code>extra ~ 1</code>, eli ns. <code>formula</code>-objektin ensimmäisenä argumenttina, joka on osa R:n syntaksia tilastollisten mallien ja riippuvuusrakenteiden määrittellyyn. Kaava määrittelee, että <code>~</code>-merkin vasen puoli on vastemuuttuja, ja oikea puoli sisältää selittävät muuttujat. Koska emme tee testiä minkään toisen muuttujan suhteen, niin kaavan oikean puoli on vain luku 1, joka R:n syntaksissa tarkoittaa, että se on vakio. Tämä ei siis tarkoita esimerkiksi sitä, että nollahypoteesimme olisi, että muutos unen määrässä olisi 1 tunti. Nollahypoteesin mukainen odotusarvo määritellään argumentilla <code>mu</code>, joka yhden otoksen testissä saa oletusarvon 0.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="tests.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One sample test</span></span>
<span id="cb384-2"><a href="tests.html#cb384-2" aria-hidden="true" tabindex="-1"></a>tt1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(extra <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> sleep)</span>
<span id="cb384-3"><a href="tests.html#cb384-3" aria-hidden="true" tabindex="-1"></a>tt1</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  extra
## t = 3.413, df = 19, p-value = 0.002918
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  0.5955845 2.4844155
## sample estimates:
## mean of x 
##      1.54</code></pre>
<p>Tuloksena saamme t-testisuureen arvon, vapausasteet sekä testin p-arvon. Koska p-arvo on pieni (perinteisesti rajana käytetään lukua 0.05, mutta tämä vaihtelee tieteenalasta riippuen) niin nollahypoteesi hylätään, eli testin mukaan muutos unen määrässä poikkeaa tilastollisesti merkitsevästi nollasta kumpaa tahansa lääkettä käytettäessä.</p>
<p>Testiin liittyvät tunnusluvut saamme eriteltyä tulosobjektista <code>tt1</code> seuraavasti:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="tests.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test statistic</span></span>
<span id="cb386-2"><a href="tests.html#cb386-2" aria-hidden="true" tabindex="-1"></a>tt1<span class="sc">$</span>statistic</span></code></pre></div>
<pre><code>##        t 
## 3.412965</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="tests.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb388-2"><a href="tests.html#cb388-2" aria-hidden="true" tabindex="-1"></a>tt1<span class="sc">$</span>parameter</span></code></pre></div>
<pre><code>## df 
## 19</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="tests.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value</span></span>
<span id="cb390-2"><a href="tests.html#cb390-2" aria-hidden="true" tabindex="-1"></a>tt1<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.00291762</code></pre>
</div>
<div id="kahden-otoksen-t-testi" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Kahden otoksen t-testi</h3>
<p>Entäpä jos haluammekin testata hypoteesia, että kumpikin lääke vaikuttaa samalla tavalla unen määrään (<span class="math inline">\(H_0 : \mu_1 = \mu_2\)</span>)? Voimme tässäkin tapauksessa käyttää <code>formula</code>-syntaksia hyödyksi. Vakion 1 sijaan sijoitamme nyt lääkettä vastaavan muuttujan <code>group</code> kaavassa <code>~</code>-merkin oikealle puolelle.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="tests.html#cb392-1" aria-hidden="true" tabindex="-1"></a>tt2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span>
<span id="cb392-2"><a href="tests.html#cb392-2" aria-hidden="true" tabindex="-1"></a>tt2</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  extra by group
## t = -1.8608, df = 17.776, p-value = 0.07939
## alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
## 95 percent confidence interval:
##  -3.3654832  0.2054832
## sample estimates:
## mean in group 1 mean in group 2 
##            0.75            2.33</code></pre>
<p>Testiobjektin sisältö vastaa yhden otoksen testiä suurimmilta osin. Näämme, että testin tulos ei tällä kertaa ollut tilastollisesti merkitsevä (merkitsevyystasolla 0.05) eli testin mukaan ei ole näyttöä siitä, että lääkkeet vaikuttaisivat eri tavalla unen määrään, jolloin nollahypoteesia ei hylätä.</p>
<p>Tarkkasilmäinen lukija saattoi kuitenkin huomata, että tämä testi ei aivan vastaa tarkoitusta, sillä <code>sleep</code>-aineistossa jokainen koehenkilö kokeili kumpaakin lääkettä, jolloin oikea tapa olisi testata lääkkeiden vaikutuksen erotusta, mikä tehdäänkin seuraavaksi.</p>
</div>
<div id="parittaisten-otosten-t-testi" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Parittaisten otosten t-testi</h3>
<p>Jotta mittausparit tulevat otettua huomioon testissä, on <code>t.test</code>-funktiolle annettava argumentti <code>paired = TRUE</code>. Tässä testissä nollahypoteesi on, että lääkkeiden vaikutuksen erotuksen odotusarvo on 0 (<span class="math inline">\(H_0 : \mu_d = 0\)</span>).</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="tests.html#cb394-1" aria-hidden="true" tabindex="-1"></a>tt3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb394-2"><a href="tests.html#cb394-2" aria-hidden="true" tabindex="-1"></a>tt3</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  extra by group
## t = -4.0621, df = 9, p-value = 0.002833
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.4598858 -0.7001142
## sample estimates:
## mean of the differences 
##                   -1.58</code></pre>
<p>Tällä kertaa tulos on taas tilastollisesti merkitsevä, eli lääkkeiden vaikutuksessa unen määrään on tilastollisesti merkitsevä ero, jolloin nollahypoteesi hylätään.</p>
<!-- Santtu: Kirjoitin t-testit kokonaan uudelleen yllä
## Kahden otoksen t-testi

Kahden otoksen t-testi soveltuu tilanteeseen, jossa kahden erillisen joukon keskiarvoja halutaan verrata ja selvittää voiko kyseinen ero johtua sattumasta. Mikäli samasta joukosta on tehty kaksi mittausta, on kyseessä riippuvat otokset ja tulee käyttää riippuvien otosten t-testiä.


```r
# evaluate the averages of variables for men and women
# there are many ways to do this but one is to use subset to extract separate data set for men and women indepenently
# we also choose just columns with numeric data (height, weight, BMI)
study_data_male <- subset(x=study_data,subset= gender == "male", select = c("height","weight","BMI"))
study_data_female <- subset(x=study_data,subset= gender == "female", select = c("height","weight","BMI"))

# apply-function can be used to calculate function for multiple columns with one command
avg_male <- apply(study_data_male,MARGIN=2,FUN=mean,na.rm=T)
avg_female <- apply(study_data_female,MARGIN=2,FUN=mean,na.rm=T)

avg_male
```

```
##   height   weight      BMI 
## 180.8000  65.3800  19.8978
```

```r
avg_female
```

```
##   height   weight      BMI 
## 171.6333  62.3000 746.2168
```

```r
# regarding just height, apply does the same as
mean(study_data_male$height,na.rm=TRUE)
```

```
## [1] 180.8
```

```r
mean(study_data_female$height,na.rm=TRUE)
```

```
## [1] 171.6333
```
Yllä olevasta koodistamme huomasimme että aineistossa miesten keskimäärinen pituus on ``180.8`` cm ja naisten on ``171.6333333`` cm. Varianssianalyysillä voidaan selvittää onko kolmen tai useamman ryhmän välillä eroa vähintään joidenkin ryhmien osalta.

 * H_0: Ryhmien odotusarvot ovat yhtäsuuret tarkasteltavan muuttujan suhteen ($\mu_1 = \mu_2$),
 * H_1: Ryhmien odotusarvot ovat erisuuret tarkasteltavan muuttujan suhteen ($\mu_i \ne \mu_j$).
 

```r
# conduct Analysis of Variance (ANOVA) for study_data
# we test if averages of height

t.test(height ~ fgender,data=study_data)
```

```
## 
##  Welch Two Sample t-test
## 
## data:  height by fgender
## t = -1.2253, df = 3.2583, p-value = 0.3016
## alternative hypothesis: true difference in means between group female and group male is not equal to 0
## 95 percent confidence interval:
##  -31.94237  13.60903
## sample estimates:
## mean in group female   mean in group male 
##             171.6333             180.8000
```
-->
</div>
</div>
<div id="chi-squared-test" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Khiin neliö -testi</h2>
<p>Kahden kategorisen muuttujan riippuvuuden tutkimiseen voidaan käyttää khiin neliö -testiä. Tyypillisesti halutaan verrata jotain ryhmien välisiä eroja, kuten puoluekannatusta alueittain tai sukupuolten suhteen. Testin ideana on verrata havaittua ristiintaulukkoa nollahypoteesin mukaiseen ristiintaulukkoon, jossa muuttujien välillä ei ole lainkaan riippuvuutta. Khiin neliö -testin testisuure perustuu näiden kahden taulukon eroihin.</p>
<p>Tarkastellaan Yhdysvaltalaista kyselytutkimusaineistoa, joka sisältää tiedon henkilön puoluekannatuksesta ja sukupuolesta. Tutkitaan khiin neliö -testin avulla, riippuuko puoluekannatus sukupuolesta. R:ssä tämä voidaan tehdä funktiolla <code>chisq.test</code>.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="tests.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="do">## From Agresti(2007) p.39</span></span>
<span id="cb396-2"><a href="tests.html#cb396-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">as.table</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">762</span>, <span class="dv">327</span>, <span class="dv">468</span>), <span class="fu">c</span>(<span class="dv">484</span>, <span class="dv">239</span>, <span class="dv">477</span>)))</span>
<span id="cb396-3"><a href="tests.html#cb396-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(M) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gender =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>),</span>
<span id="cb396-4"><a href="tests.html#cb396-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">party =</span> <span class="fu">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Independent&quot;</span>, <span class="st">&quot;Republican&quot;</span>))</span>
<span id="cb396-5"><a href="tests.html#cb396-5" aria-hidden="true" tabindex="-1"></a>(Xsq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(M))  <span class="co"># Prints test summary</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  M
## X-squared = 30.07, df = 2, p-value = 2.954e-07</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="tests.html#cb398-1" aria-hidden="true" tabindex="-1"></a>Xsq<span class="sc">$</span>observed   <span class="co"># observed counts (same as M)</span></span></code></pre></div>
<pre><code>##       party
## gender Democrat Independent Republican
##      F      762         327        468
##      M      484         239        477</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="tests.html#cb400-1" aria-hidden="true" tabindex="-1"></a>Xsq<span class="sc">$</span>expected   <span class="co"># expected counts under the null</span></span></code></pre></div>
<pre><code>##       party
## gender Democrat Independent Republican
##      F 703.6714    319.6453   533.6834
##      M 542.3286    246.3547   411.3166</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="tests.html#cb402-1" aria-hidden="true" tabindex="-1"></a>Xsq<span class="sc">$</span>residuals  <span class="co"># Pearson residuals</span></span></code></pre></div>
<pre><code>##       party
## gender   Democrat Independent Republican
##      F  2.1988558   0.4113702 -2.8432397
##      M -2.5046695  -0.4685829  3.2386734</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="tests.html#cb404-1" aria-hidden="true" tabindex="-1"></a>Xsq<span class="sc">$</span>stdres     <span class="co"># standardized residuals</span></span></code></pre></div>
<pre><code>##       party
## gender   Democrat Independent Republican
##      F  4.5020535   0.6994517 -5.3159455
##      M -4.5020535  -0.6994517  5.3159455</code></pre>
<p>Koska testin p-arvo on pieni, niin nollahypoteesi hylätään ja todetaan, että puoluekannatus riippuu tilastollisesti merkitsevästi sukupuolesta. Testin luotettavuuden kannalta on kuitenkin hyvä huomioida, että testiin liittyy oletuksia, jotka koskevat odotettuja frekvenssejä (eli nollahypoteesin mukaisen ristiintaulukon frekvenssejä). Tyypillisesti vaaditaan, että odotetun frekvenssin on oltava vähintään 5 vähintään 80%:ssa taulukon soluista, eikä yhdenkään solun odotettu frekvenssi ole alle 1. Tarkistetaan oletukset edellisen esimerkin tapauksessa:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="tests.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(Xsq<span class="sc">$</span>expected <span class="sc">&gt;=</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="tests.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Xsq<span class="sc">$</span>expected <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">&gt;=</span> <span class="fl">0.80</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Oletukset ovat tältä osin kunnossa. Edellä funktio <code>all</code> ottaa syötteenään loogisen vektorin ja palauttaa <code>TRUE</code> jos syötteen kaikki alkiot ovat <code>TRUE</code>. Muutoin funktio palauttaa <code>FALSE</code>.</p>
<!-- Santtu: Monte Carlo menee varmaan yli kurssin aihepiiristä
## Effect of simulating p-values
x <- matrix(c(12, 5, 7, 7), ncol = 2)
chisq.test(x)$p.value           # 0.4233
chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value -->
</div>
<div id="anova" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Varianssianalyysi</h2>
<p>Varianssianalyysin voidaan ajatella olevan t-testin yleistys, jossa yhden tai kahden odotusarvon sijaan verrataankin kerralla useamman ryhmän odotusarvoja keskenään. Menetelmä saa nimensä siitä, että sen testisuure perustuu kiinnostuksen kohteena olevan muuttujan kokonaisvaihtelun jakamiseen verratavien ryhmien sisäiseen vaihteluun ja niiden väliseen vaihteluun. Koska harjoitusaineistossa <code>study_data</code> ei vielä ole kategorista muuttujaa, jossa on vähintään kolme kategoriaa, niin luodaan sellainen.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="tests.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new categorical variable called age_group</span></span>
<span id="cb410-2"><a href="tests.html#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="co">#3,5,6 =&gt; ryhmä 1</span></span>
<span id="cb410-3"><a href="tests.html#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="co">#2,4,8 =&gt; ryhmä 2</span></span>
<span id="cb410-4"><a href="tests.html#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="co">#1,7   =&gt; ryhmä 3</span></span>
<span id="cb410-5"><a href="tests.html#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="co"># vaste: weight</span></span>
<span id="cb410-6"><a href="tests.html#cb410-6" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;3&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;2&quot;</span>)</span>
<span id="cb410-7"><a href="tests.html#cb410-7" aria-hidden="true" tabindex="-1"></a>study_data<span class="sc">$</span>fage_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(study_data<span class="sc">$</span>age_group)</span></code></pre></div>
<p>Hypoteesit ovat:
- <span class="math inline">\(H_0\)</span>: Ryhmien odotusarvot ovat samat tarkasteltavan muuttujan suhteen (<span class="math inline">\(\mu_1 = \mu_2 = \dots = \mu_n\)</span>),
- <span class="math inline">\(H_1\)</span>: Ryhmien odotusarvoissa on eroa tarkasteltavan muuttujan suhteen (<span class="math inline">\(\mu_i \ne \mu_j\)</span> ainakin joillekin <span class="math inline">\(i \ne j\)</span>).</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="tests.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conduct Analysis of Variance (ANOVA) for study_data</span></span>
<span id="cb411-2"><a href="tests.html#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we test if averages of height differ between age groups</span></span>
<span id="cb411-3"><a href="tests.html#cb411-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(height <span class="sc">~</span> fage_group, <span class="at">data =</span> study_data))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## fage_group   2  198.7   99.34   1.097  0.417
## Residuals    4  362.4   90.60               
## 1 observation deleted due to missingness</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="tests.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(height <span class="sc">~</span> fage_group, <span class="at">data =</span> study_data[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">3</span>),])) <span class="co"># the same data three times</span></span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## fage_group   2  596.1   298.0   4.934 0.0196 *
## Residuals   18 1087.2    60.4                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 3 observations deleted due to missingness</code></pre>
</div>
<div id="levene" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Levenen testi</h2>
<p>Levenen testillä tutkitaan ovatko jonkin muuttujan varianssit samat kahdessa tai useammassa ryhmässä. Testiä ei ole toteutettu perus R:ssä, mutta se on saatavilla Rcourse-paketin kautta funktiossa <code>leveneTest</code>. Testin nollahypoteesi on, että muuttujan varianssit ovat samat joka ryhmässä.</p>
<p>Selvitetään onko harjoitusaineiston <code>study_data</code> muuttujan <code>height</code> varianssissa eroa eri ikäryhmien välillä (<code>fage_group</code>) Levenen testillä.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="tests.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(height <span class="sc">~</span> fage_group, <span class="at">data =</span> study_data)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  2  0.5597 0.6105
##        4</code></pre>
<p>Testin p-arvo löytyy sarakkeesta <code>Pr(&gt;F)</code>, ja se on noin <span class="math inline">\(0.61\)</span>. Testin mukaan muuttujan varianssit ovat siis samat joka ryhmässä, ja nollahypoteesi jää voimaan.</p>
</div>
<div id="shapiro" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Shapiro-Wilk -testi</h2>
<p>Shapiro-Wilk -testillä tutkitaan onko jokin muuttuja normaalijakautunut. Testi löytyy funktiosta <code>shapiro.test</code>, ja se ottaa argumenttinaan yhden muuttujan havainnot vektorina. Funktiolla ei voi siis suoraan testata esimerkiksi sitä, onko muuttuja normaalijakautunut joissakin osaryhmissä, vaan aineisto on ensin jaettava sopiviin osiin. Testin nollahypoteesi on, että muuttuja on normaalijakautunut.</p>
<p>Tarkastellaan jälleen harjoitusaineistoa <code>study_data</code> ja testataan muuttujan <code>height</code> normaalisuutta.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="tests.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(study_data<span class="sc">$</span>height)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  study_data$height
## W = 0.96985, p-value = 0.8973</code></pre>
<p>Testin p-arvon voi lukea kohdasta <code>p-value</code> ja se on aineistolle noin <span class="math inline">\(0.90\)</span>, eli <code>height</code>-muuttuja on testin mukaan normaalijakautunut, ja nollahypoteesi jää voimaan.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-ohjelmoinnin-perusteet.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
